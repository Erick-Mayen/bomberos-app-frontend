<div class="login-container">
  <!-- Animated background -->
  <div class="background-animation"></div>

  <div class="login-wrapper">
    <!-- Header Section -->
    <div class="header-section">
      <div class="logo-container">
        <img
          src="assets/logo-bomb46.png"
          alt="Logo Bomberos"
          class="logo-img"
        />
      </div>
      <h1 class="main-title">Bomberos Municipales</h1>
      <p class="subtitle">Estación No.46 Palencia</p>
    </div>

    <!-- Login Card -->
    <div class="login-card">
      <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
        <!-- Password Field -->
        <div class="form-group">
          <label for="actualPassword" class="form-label"
            >Contraseña Actual</label
          >
          <div
            class="input-container"
            [class.error]="isFieldInvalid('actualPassword')"
          >
            <fa-icon [icon]="'lock'" class="input-icon"></fa-icon>
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="actualPassword"
              formControlName="actualPassword"
              class="form-input"
              placeholder="Ingresa tu contraseña"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="togglePassword()"
            >
              <fa-icon
                [icon]="showPassword ? 'eye-slash' : 'eye'"
                class="eye-icon"
              ></fa-icon>
            </button>
          </div>
          <div class="error-message" *ngIf="isFieldInvalid('actualPassword')">
            <fa-icon
              [icon]="'exclamation-triangle'"
              class="error-icon"
            ></fa-icon>
            {{ getFieldError("actualPassword") }}
          </div>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <label for="newPassword" class="form-label">Nueva Contraseña</label>
          <div
            class="input-container"
            [class.error]="isFieldInvalid('newPassword')"
          >
            <fa-icon [icon]="'lock'" class="input-icon"></fa-icon>
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="newPassword"
              formControlName="newPassword"
              class="form-input"
              placeholder="Ingresa tu contraseña"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="togglePassword()"
            >
              <fa-icon
                [icon]="showPassword ? 'eye-slash' : 'eye'"
                class="eye-icon"
              ></fa-icon>
            </button>
            <fa-icon
              *ngIf="
                passwordsMatch() && loginForm.get('confirmNewPassword')?.dirty
              "
              [icon]="'check-circle'"
              class="success-icon"
            ></fa-icon>
          </div>
          <div class="error-message" *ngIf="isFieldInvalid('newPassword')">
            <fa-icon
              [icon]="'exclamation-triangle'"
              class="error-icon"
            ></fa-icon>
            {{ getFieldError("newPassword") }}
          </div>
        </div>

        <!-- Password Field -->
        <div class="form-group">
          <label for="confirmNewPassword" class="form-label"
            >Confirmar Nueva Contraseña</label
          >
          <div
            class="input-container"
            [class.error]="isFieldInvalid('confirmNewPassword')"
          >
            <fa-icon [icon]="'lock'" class="input-icon"></fa-icon>
            <input
              [type]="showPassword ? 'text' : 'password'"
              id="confirmNewPassword"
              formControlName="confirmNewPassword"
              class="form-input"
              placeholder="Ingresa tu contraseña"
            />
            <button
              type="button"
              class="password-toggle"
              (click)="togglePassword()"
            >
              <fa-icon
                [icon]="showPassword ? 'eye-slash' : 'eye'"
                class="eye-icon"
              ></fa-icon>
            </button>
            <fa-icon
              *ngIf="
                passwordsMatch() && loginForm.get('confirmNewPassword')?.dirty
              "
              [icon]="'check-circle'"
              class="success-icon"
            ></fa-icon>
          </div>
          <div
            class="error-message"
            *ngIf="isFieldInvalid('confirmNewPassword')"
          >
            <fa-icon
              [icon]="'exclamation-triangle'"
              class="error-icon"
            ></fa-icon>
            {{ getFieldError("confirmNewPassword") }}
          </div>
        </div>

        <div
          class="error-message"
          *ngIf="loginForm.errors?.['passwordsMismatch'] && loginForm.get('confirmNewPassword')?.touched"
        >
          <fa-icon [icon]="'exclamation-triangle'" class="error-icon"></fa-icon>
          Las contraseñas no coinciden
        </div>

        <!-- Submit Button -->
        <button
          type="submit"
          class="submit-button"
          [disabled]="isLoading"
          [class.loading]="isLoading"
        >
          <div class="button-content" *ngIf="!isLoading">
            <svg
              class="button-icon"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
            </svg>
            Cambiar Contraseña
          </div>
          <div class="button-loading" *ngIf="isLoading">
            <div class="spinner"></div>
            Cambiando Contraseña...
          </div>
        </button>
      </form>
    </div>
  </div>
</div>
